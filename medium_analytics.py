#ğŸ§  Medium Tasks (Ğ¤Ğ¸Ñ‚Ğ½ĞµÑ-Ğ¢Ñ€ĞµĞºĞµÑ€)

# 1. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼ (event_flag)
# ĞĞ°Ğ¹Ğ´Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ heart_rate, Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ñ‡Ğ°ÑÑ‹, ĞºĞ¾Ğ³Ğ´Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â€” 'workout'.
# ĞŸĞ¾ÑÑ‡Ğ¸Ñ‚Ğ°Ğ¹ ÑÑ€ĞµĞ´Ğ½ĞµĞµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ skin_temp Ğ² Ñ‡Ğ°ÑÑ‹, ĞºĞ¾Ğ³Ğ´Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â€” 'normal'.
# 2. ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ (steps_count)
# Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° ÑˆĞ°Ğ³Ğ¾Ğ² Ğ¿Ğ¾ Ñ‡Ğ°ÑĞ°Ğ¼ (Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñƒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¼ Ğ¸ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼).
# ĞĞ°Ğ¹Ğ´Ğ¸ Ñ‡Ğ°ÑÑ‹, ĞºĞ¾Ğ³Ğ´Ğ° steps_count Ğ²Ñ‹Ñ€Ğ¾Ñ Ğ¿Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¼.
# 3. ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
# ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¹ 2D-Ğ¼Ğ°ÑÑĞ¸Ğ², Ğ³Ğ´Ğµ:
# 1-Ñ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ° â€” time_point
# 2-Ñ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ° â€” heart_rate
# ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸, Ğ² ĞºĞ°ĞºĞ¾Ğ¹ Ñ‡Ğ°Ñ heart_rate Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³ Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼Ğ°.
# 4. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (event_flag == 'sleep')
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼, Ñ‡Ñ‚Ğ¾ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ ÑĞ½Ğ° steps_count Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚ĞµĞ½. Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸ Ğ²ÑĞµ Ñ‚Ğ°ĞºĞ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ½Ğ° np.nan.
# Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¿ĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ğ°Ğ¹ ÑÑ€ĞµĞ´Ğ½ĞµĞµ steps_count, Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒÑ NaN: np.nanmean(...).



import json
import pandas as pd
import numpy as np

# Upload JSON-file
with open("experiment_output.json", "r") as file:
    data = json.load(file)

# Make DataFrame
df = pd.DataFrame(data)

# 1.1 Calculate the average skin_temp value during the hours when the event is 'normal'.
avg_temp_normal = df.loc[df["event_flag"] == "normal", "skin_temp"].mean()
print("ğŸŒ¡ Average skin temperature at 'normal':", round(avg_temp_normal, 2), "Â°C")

# 1.2 Calculate the average skin_temp value during the hours when the event is 'normal'.
avg_temp_normal = df.loc[df["event_flag"] == "normal", "skin_temp"].mean()
print("ğŸŒ¡ Average skin temperature at 'normal':", round(avg_temp_normal, 2), "Â°C")

# 2.1 Calculate the change in the number of steps per hour (the difference between the current and previous value)
df["step_change"] = df["steps_count"].diff()
print("ğŸ“ˆ Changing the number of steps by hour:")
print(df[["time_point", "steps_count", "step_change"]].head(10))

# 2.2 Find the hours when steps_count increased compared to the previous one.
increased_steps = df[df["step_change"] > 0]
print("ğŸ”¼ Hours when the number of steps increased:")
print(increased_steps[["time_point", "steps_count", "step_change"]].to_string(index=False))

# 3.1 Step 1: Build a 2D array
hr_array = df[["time_point", "heart_rate"]].to_numpy()
print("ğŸ“Š 2D-array (time_point, heart_rate):")
print(hr_array[:5])  # Ğ¿Ğ¾ĞºĞ°Ğ¶ĞµĞ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 5 ÑÑ‚Ñ€Ğ¾Ğº

# 3.2 Step 2: Find your maximum heart rate hour
max_idx = df["heart_rate"].idxmax()
max_time = df.loc[max_idx, "time_point"]
max_hr = df.loc[max_idx, "heart_rate"]
print(f"ğŸ’“ Maximum heart rate {max_hr} bpm Ğ±Ñ‹Ğ» Ğ² {max_time}:00")

# 4.1 We believe that during sleep steps_count is incorrect. Replace all such values â€‹â€‹with np.nan.
df["steps_cleaned"] = df["steps_count"].copy()
df.loc[df["event_flag"] == "sleep", "steps_cleaned"] = np.nan

# 4.2 Now recalculate the steps_count average, ignoring NaNs: np.nanmean(...).
avg_steps_cleaned = np.nanmean(df["steps_cleaned"])
print(f"ğŸš¶ Average number of steps (without sleep): {round(avg_steps_cleaned, 2)}")
